```

using System;
using Com.Relation;
using UnityEngine;
using UnityEngine.Events;
using static UnityEngine.Mathf;

namespace Equip.Behaviour.ForkLift
{
    public class SphereBehaviour : EquipBehaviour
    {
        #region 配置顶
        [SerializeField] float MIN_SHPERE_WIDTH = 0.1f;
        [SerializeField] float MAX_SHPERE_WIDTH = 2f;

        [SerializeField] float MIN_SHPERE_HEIGHT = 0.1F;
        [SerializeField] float MAX_SHPERE_HEIGHT = 2f;

        [SerializeField] float MIN_SHPERE_LENGTH = 0.1f;
        [SerializeField] float MAX_SHPERE_LENGTH = 2f;
        #endregion

        public BoxCollider boxC;

        float forkwidth = 0.5f;
        public float ForkWidth
        {
            get => forkwidth;
            set => forkwidth = Clamp(value, MIN_SHPERE_WIDTH, MAX_SHPERE_WIDTH);
        }

        float forkheight = 0.2f;
        public float ForkHeight
        {
            get => forkheight;
            set => forkheight = Clamp(value, MIN_SHPERE_HEIGHT, MAX_SHPERE_HEIGHT);
        }

        float forklength = 1f;
        public float ForkLength
        {
            get => forklength;
            set => forklength = Clamp(value, MIN_SHPERE_LENGTH, MAX_SHPERE_LENGTH);
        }

        void BuildMesh()
        {
#if UNITY_EDITOR
            Awake();
#endif


        }

        private void ResetInfo()
        {
            EquipType = EquipType.Sphere;

            Name = "#Sphere";
        }

        public event Action OnBuildMesh;
        public override void ApplyInfo()
        {
            BuildMesh();
            OnBuildMesh?.Invoke();
            base.ApplyInfo();
        }

        #region override
        public override int SubType => 0;

        public override void Init()
        {
            ResetInfo();
            ApplyInfo();
            base.Init();
        }

        public override void Init(Guid guid)
        {
            ResetInfo();
            ApplyInfo();
            base.Init(guid);
        }
        #endregion

        void Awake()
        {
            boxC = GetComponent<BoxCollider>();
        }
        void Start()
        {
            if (Avaliable == LifeState.Constructed)
            {
                Init();
            }
        }
    }

}

```

```
using System;
using System.Xml.Linq;
using Equip.Behaviour.ForkLift;
using Equip.Factory;
using Equip.Serialize;
using Equip.Utility;
using UnityEngine;
using WKX.CommonTool;
using WKX.MyReflection;
using WKX.ViewLayer;
using WKX.ViewLayer.Message;

namespace Equip.Handle
{
    [RequireComponent(typeof(SphereBehaviour))]
    public class SphereHandle : AbsCommonEquipHandle<SphereBehaviour>
    {
        public override string InspectorTitle => "Sphere";

        protected override void Start()
        {
            _ = GetComponent<RxDragHandle>() || gameObject.AddComponent<RxDragHandle>();

            base.Start();
        }

        public override Bounds JustLocalBounds => new Bounds(behaviour.boxC.center, behaviour.boxC.size);

        #region Inspector properties
        [InspectorField(EditType = InspectorFieldAttribute.Type.Text, Name = "名称")]
        public string Name
        {
            get => behaviour.Name;
            set => behaviour.WrappedSetter((b, v) => b.Name = v, applyInfoFunc,
                value, behaviour.Name);
        }

        [InspectorField(EditType = InspectorFieldAttribute.Type.Integer, Name = "长度")]
        public int ForkLength
        {
            get => behaviour.ForkHeight.ToMillimeter();
            set => behaviour.WrappedSetter((b, v) => b.ForkLength = v * 1e-3f, applyInfoFunc,
                value, behaviour.ForkLength.ToMillimeter());
        }

        [InspectorField(EditType = InspectorFieldAttribute.Type.Integer, Name = "外宽")]
        public int ForkWidth
        {
            get => behaviour.ForkWidth.ToMillimeter();
            set => behaviour.WrappedSetter((b, v) => b.ForkWidth = v * 1e-3f, applyInfoFunc,
                value, behaviour.ForkWidth.ToMillimeter());
        }

        [InspectorField(EditType = InspectorFieldAttribute.Type.Integer, Name = "高度")]
        public int ForkHeight
        {
            get => behaviour.ForkHeight.ToMillimeter();
            set => behaviour.WrappedSetter((b, v) => b.ForkHeight = v * 1e-3f, applyInfoFunc,
                value, behaviour.ForkHeight.ToMillimeter());
        }
        #endregion

        #region ICloneableEntity
        SphereSerialize serializer;
        public override Func<ICloneableEntity> CloneSelfFunction()
        {
            _ = serializer || (serializer = GetComponent<SphereSerialize>());
            var subType = behaviour.SubType;
            var xml = serializer.Serialize();
            return () =>
            {
                var copy = EquipFactory.CreateEquip(EquipType.Sphere, subType);
                var copySerializer = copy.GetComponent<SphereSerialize>();
                copySerializer.DeSerializeFit(xml);
                return copy.GetComponent<SphereHandle>();
            };
        }
        #endregion
    }
}
```

```
using System.Xml.Linq;
using Equip.Behaviour.ForkLift;
using Equip.Handle;
using Equip.Utility;
using UnityEngine;
using WKX.CommonTool;

namespace Equip.Serialize
{
    public class SphereSerialize : MonoBehaviour, IEquipSerialize
    {
        SphereHandle handle;
        SphereHandle Handle => handle ? handle : (handle = GetComponent<SphereHandle>());
        SphereBehaviour Behaviour => Handle;

        /* <ForkLift_1 name="" guid="">
         *   <position x="" y="" z=""/>
         *   <eulerAngles x="" y="" z=""/>
         *   <forkWidth></forkWidth>
         *   <forkHeight></forkHeight>
         *   <forkLength></forkLength>
         * <ForkLift_1/>
         */

        public XElement Serialize()
        {
            var node = new XElement(Behaviour.EquipKey, new XAttribute("Sphere", Behaviour.Guid), new XAttribute("name", Behaviour.Name));
            node.Add(new XElement("position").AddXAttributeVector3(transform.position));
            node.Add(new XElement("eulerAngles").AddXAttributeVector3(transform.eulerAngles));
            node.Add(new XElement("forkWidth", Behaviour.ForkWidth.ToMillimeter()));
            node.Add(new XElement("forkHeight", Behaviour.ForkHeight.ToMillimeter()));
            node.Add(new XElement("forkLength", Behaviour.ForkLength.ToMillimeter()));

            return node;
        }

        public void DeSerializeFit(XElement element, float floorLevel = 0)
        {
            var name = element.Attribute("name")?.Value ?? "Sphere";
            Behaviour.Name = name;

            var upwards = Vector3.up * floorLevel;
            element.SetPropertyFromElement(Behaviour, e => e.Element("position")?.XAttributeToVector3(), (c, v) => c.transform.position = v + upwards);
            element.SetPropertyFromElement(Behaviour, e => e.Element("eulerAngles")?.XAttributeToVector3(), (c, v) => c.transform.eulerAngles = v);

            element.SetPropertyFromElement(Behaviour, e => e.Element("forkWidth")?.Value.ParseOrNull() * 1e-3f, (c, v) => c.ForkWidth = v);
            element.SetPropertyFromElement(Behaviour, e => e.Element("forkHeight")?.Value.ParseOrNull() * 1e-3f, (c, v) => c.ForkHeight = v);
            element.SetPropertyFromElement(Behaviour, e => e.Element("forkLength")?.Value.ParseOrNull() * 1e-3f, (c, v) => c.ForkLength = v);

            Behaviour.ApplyInfo();
        }
    }
}
```

